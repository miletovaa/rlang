---
title: "Data Programming"
subtitle: "Homework 3"
author: "Anna Miletova"
date: "`r format(Sys.time(), '%e %B %Y')`"
format: 
  html:
  embed-resources: true
execute: 
  warning: false
messages: false
echo: true
error: true
---
  
```{r}
# libs
library(tibble)
library(ggplot2)
```

### 1. Draw a line chart with ggplot 
...of temperature over time side by side for the 2 the build-in data frames beaver1 and beaver2. Add a Title and units on the Y-axis for temperature.

```{r}

combined_data <- rbind(transform(beaver1, dataframe = "beaver1"), transform(beaver2, dataframe = "beaver2"))

ggplot(combined_data, aes(x = time, y = temp, color = dataframe)) +
  geom_line() +
  labs(title = "Temperature of beavers over time",
       y = "Temperature (Â°C)",
       x = "") +
  facet_wrap(~ dataframe, scales = "fixed")

```


### 2. You are given the worth of 1 EUR in some currencies.

Write a function of two parameters

* a named numeric vector, with values representing the amount of currency in the corresponding name owned,
* (optional) a currency to convert to.

The function returns the total amount from 1. as the currency specified in 2. If currency in 2. is not specified then return the value in EUR. If a currency from 1. does not exists, then that part of the vector contributes 0 to the output. If the currency from 2. does not exist then return 0.

```{r}
convert.all <- function(amounts, currency = "EUR") {
  exchange_rates <- c(EUR = 1, datasets::euro)
  
  if (!(currency %in% names(exchange_rates))) {
    return(0)
  }
  
  total_in_eur <- 0
  
  for (i in seq_along(amounts)) {
    cur <- names(amounts)[i]
    if (cur %in% names(exchange_rates)) {
      cur_in_eur <- amounts[i] / exchange_rates[cur]
      total_in_eur <- total_in_eur + cur_in_eur
    }
  }

  if (currency == "EUR") {
    total <- as.numeric(total_in_eur)
  } else {
    total <- as.numeric(total_in_eur * exchange_rates[currency])
  }

  return(total)
}

convert.all(c(EUR = 6.5))
convert.all(c(EUR = 3, ATS = 2))
convert.all(c(EUR = 3, EUR = 2))
convert.all(c(EUR = 3, DEM = 2, SIT = 10000))
convert.all(c(EUR = 3, DEM = 2, SIT = 10000), "EUR")
convert.all(c(EUR = 3, DEM = 2, SIT = 10000), "ESP")
convert.all(c(EUR = 3, DEM = 2, LIRA = 100), "SIT")

```
